CREATE SCHEMA EST_CASO_V;

USE EST_CASO_V;

-- TABELA DE CLIENTES
CREATE TABLE IF NOT EXISTS CLIENTES (
    CLI_CPF VARCHAR(14) PRIMARY KEY,
    CLI_NOME VARCHAR(100) NOT NULL,
    CLI_RUA VARCHAR(50),
    CLI_NUMRUA VARCHAR(25) NOT NULL,
    CLI_BAIRRO VARCHAR(50) NOT NULL,
    CLI_CIDADE VARCHAR(50) NOT NULL,
    CLI_UF CHAR(2) NOT NULL,
    CLI_PAIS VARCHAR(100) NOT NULL,
    CLI_CEP VARCHAR(15) NOT NULL,
    CLI_STATUS_PROMO ENUM('APROVADO', 'REPROVADO') NOT NULL
);

-- TABELA DE FORNECEDORES
CREATE TABLE IF NOT EXISTS FORNECEDORES (
    FORN_CNPJ VARCHAR(14) PRIMARY KEY,
    FORN_NOME VARCHAR(100) NOT NULL,
    FORN_TELEFONE VARCHAR(16) NOT NULL,
    FORN_EMAIL VARCHAR(50) NOT NULL
);

-- TABELA DE PRODUTOS
CREATE TABLE IF NOT EXISTS PRODUTOS (
    PROD_ID INT PRIMARY KEY,
    PROD_CATEGORIA VARCHAR(50) NOT NULL,
    PROD_QTDDISPONIVEL INT NOT NULL,
    PROD_PRECO DECIMAL(10, 3) NOT NULL
);

-- TABELA ASSOCIATIVA ENTRE PRODUTOS E FORNECEDORES
CREATE TABLE IF NOT EXISTS PRODUTOS_FORNECEDORES (
    PROD_ID INT,
    FORN_CNPJ VARCHAR(14),
    PRIMARY KEY (PROD_ID, FORN_CNPJ),
    CONSTRAINT PRFO_FK_PRODUTOS FOREIGN KEY (PROD_ID) REFERENCES PRODUTOS(PROD_ID),
    CONSTRAINT PRFO_FK_FORNECEDORES FOREIGN KEY (FORN_CNPJ) REFERENCES FORNECEDORES(FORN_CNPJ)
);

-- TABELA DE PAGAMENTOS
CREATE TABLE IF NOT EXISTS PAGAMENTOS (
    PAG_ID INT PRIMARY KEY,
    PAG_DATA DATE NOT NULL,
    PAG_HORA TIME NOT NULL,
    PAG_VALOR DECIMAL(10, 3) NOT NULL,
    PAG_STATUS ENUM('PENDENTE', 'PAGO', 'CANCELADO') NOT NULL
);

-- TABELA DE VENDAS
CREATE TABLE IF NOT EXISTS VENDAS (
    VENDA_ID INT PRIMARY KEY,
    CLI_CPF VARCHAR(14) NOT NULL,
    PAG_ID INT NOT NULL,
    CONSTRAINT VENDA_FK_CLIENTES FOREIGN KEY (CLI_CPF) REFERENCES CLIENTES(CLI_CPF),
    CONSTRAINT VENDA_FK_PAGAMENTOS FOREIGN KEY (PAG_ID) REFERENCES PAGAMENTOS(PAG_ID)
);

-- TABELA ASSOCIATIVA ENTRE VENDAS E PRODUTOS
CREATE TABLE IF NOT EXISTS VENDAS_PRODUTOS (
    VENDA_ID INT,
    PROD_ID INT,
    PRIMARY KEY (VENDA_ID, PROD_ID),
    VEPRO_QTD_VENDIDA INT NOT NULL,
    VEPRO_VALORTOTAL DECIMAL(10, 3) NOT NULL,
    CONSTRAINT VEPRO_FK_PRODUTOS FOREIGN KEY (PROD_ID) REFERENCES PRODUTOS(PROD_ID),
    CONSTRAINT VEPRO_FK_VENDAS FOREIGN KEY (VENDA_ID) REFERENCES VENDAS(VENDA_ID)
);



-- =====================> INSERTS <=====================

-- Tabela CLIENTES

INSERT INTO CLIENTES (CLI_CPF, CLI_NOME, CLI_RUA, CLI_NUMRUA, CLI_BAIRRO, CLI_CIDADE, CLI_UF, CLI_PAIS, CLI_CEP, CLI_STATUS_PROMO)
VALUES
('123.456.789-00', 'James T. Kirk', 'USS Enterprise', '1701', 'Ponte de Comando', 'Estação Espacial', 'SS', 'Federação Unida dos Planetas', '12345-678', 'APROVADO'),
('987.654.321-00', 'Spock', 'Comando Supremo Vulcano', '7', 'Katra', 'Vulcano', 'VU', 'Vulcano', '98765-432', 'APROVADO'),
('112.233.445-66', 'Leonard McCoy', 'Starfleet Medical', '45', 'Enfermaria', 'Estação Espacial', 'EE', 'Federação Unida dos Planetas', '23456-789', 'REPROVADO'),
('223.344.556-77', 'Jean-Luc Picard', 'USS Enterprise-D', '1701-D', 'Sala de Comando', 'Setor 001', 'EF', 'Federação Unida dos Planetas', '34567-890', 'APROVADO'),
('334.455.667-88', 'Data', 'USS Enterprise-D', '1701-D', 'Seção de Engenharia', 'Setor 001', 'EF', 'Federação Unida dos Planetas', '45678-901', 'APROVADO');

-- Tabela FORNECEDORES


INSERT INTO FORNECEDORES (FORN_CNPJ, FORN_NOME, FORN_TELEFONE, FORN_EMAIL)
VALUES
('12.345.678/0001-00', 'Starfleet Supply Corp.', '+1-800-STARFLEET', 'contato@starfleetsupply.com'),
('23.456.789/0001-11', 'Academia de Ciências Vulcana', '+1-800-VULCAN-123', 'ciencias@vulcan.edu'),
('34.567.890/0001-22', 'Logística do Império Klingon', '+1-800-KLINGON-456', 'logistica@imperioklingon.gov'),
('45.678.901/0001-33', 'Consórcio Comercial Ferengi', '+1-800-FERENGI-789', 'comercio@ferengicompany.com'),
('56.789.012/0001-44', 'Império Estelar Romulano', '+1-800-ROMULAN-101', 'informacoes@romulanstar.net');



-- Tabela PRODUTOS

INSERT INTO PRODUTOS (PROD_ID, PROD_CATEGORIA, PROD_QTDDISPONIVEL, PROD_PRECO)
VALUES
(1, 'Tecnologia', 50, 9999.99),
(2, 'Alimentos', 200, 15.50),
(3, 'Equipamentos Médicos', 75, 350.00),
(4, 'Armas', 30, 2500.00),
(5, 'Roupas Espaciais', 100, 1200.00);



-- Tabela PRODUTOs_FORNECEDORES

INSERT INTO PRODUTOS_FORNECEDORES (PROD_ID, FORN_CNPJ)
VALUES
(1, '12.345.678/0001-00'),
(2, '45.678.901/0001-33'),
(3, '23.456.789/0001-11'),
(4, '34.567.890/0001-22'),
(5, '56.789.012/0001-44');



-- Tabela PAGAMENTOS

INSERT INTO PAGAMENTOS (PAG_ID, PAG_DATA, PAG_HORA, PAG_VALOR, PAG_STATUS)
VALUES
(1, '2024-11-01', '14:30:00', 15000.00, 'PAGO'),
(2, '2024-11-05', '10:00:00', 300.00, 'PAGO'),
(3, '2024-10-20', '09:15:00', 2500.00, 'PAGO'),
(4, '2024-11-12', '16:45:00', 1200.00, 'PENDENTE'),
(5, '2024-11-15', '13:00:00', 500.00, 'PAGO');



-- Tabela VENDAS

INSERT INTO VENDAS (VENDA_ID, CLI_CPF, PAG_ID)
VALUES
(1, '123.456.789-00', 1),
(2, '987.654.321-00', 2),
(3, '223.344.556-77', 3),
(4, '334.455.667-88', 4),
(5, '112.233.445-66', 5);



-- Tabela VENDAS_PRODUTOS
INSERT INTO VENDAS_PRODUTOS (VENDA_ID, PROD_ID, VEPRO_QTD_VENDIDA, VEPRO_VALORTOTAL)
VALUES
(1, 1, 2, 19999.98),
(2, 2, 5, 77.50),
(3, 3, 1, 350.00),
(4, 4, 1, 2500.00),
(5, 5, 3, 3600.00);



-- =====================> UPDATES <=====================

-- Tabela CLIENTES
UPDATE CLIENTES SET CLI_STATUS_PROMO = 'REPROVADO' WHERE CLI_CPF = '123.456.789-00'; 
UPDATE CLIENTES SET CLI_BAIRRO = 'Nova Vulcano', CLI_CIDADE = 'Vulcano' WHERE CLI_CPF = '987.654.321-00'; 



-- Tabela FORNECEDORES

UPDATE FORNECEDORES SET FORN_TELEFONE = '+1-800-STARFLEET-999' WHERE FORN_CNPJ = '12.345.678/0001-00'; 
UPDATE FORNECEDORES SET FORN_EMAIL = 'suporte@klingonempire.gov' WHERE FORN_CNPJ = '34.567.890/0001-22'; 



-- Tabela PRODUTOS

UPDATE PRODUTOS SET PROD_QTDDISPONIVEL = 100 WHERE PROD_ID = 1; 
UPDATE PRODUTOS SET PROD_PRECO = 350.00 WHERE PROD_ID = 2; 



-- Tabela PRODUTOS_FORNECEDORES

UPDATE PRODUTOS_FORNECEDORES SET FORN_CNPJ = '45.678.901/0001-33' WHERE PROD_ID = 1 AND FORN_CNPJ = '12.345.678/0001-00';  
UPDATE PRODUTOS_FORNECEDORES SET PROD_ID = 5 WHERE FORN_CNPJ = '23.456.789/0001-11' AND PROD_ID = 3;  



-- Tabela PAGAMENTOS

UPDATE PAGAMENTOS SET PAG_STATUS = 'CANCELADO', PAG_VALOR = 0 WHERE PAG_ID = 4;  
UPDATE PAGAMENTOS SET PAG_HORA = '17:30:00' WHERE PAG_ID = 2; 



-- Tabela VENDAS

UPDATE VENDAS SET CLI_CPF = '223.344.556-77' WHERE VENDA_ID = 3;
UPDATE VENDAS SET PAG_ID = 5 WHERE VENDA_ID = 1;



-- Tabela VENDAS_PRODUTOS

UPDATE VENDAS_PRODUTOS SET VEPRO_QTD_VENDIDA = 3, VEPRO_VALORTOTAL = 29999.97 WHERE VENDA_ID = 1 AND PROD_ID = 1;
UPDATE VENDAS_PRODUTOS SET VEPRO_QTD_VENDIDA = 2, VEPRO_VALORTOTAL = 31.00 WHERE VENDA_ID = 2 AND PROD_ID = 2; 



-- =====================> UPDATES <=====================

-- Tabela CLIENTES

DELETE FROM CLIENTES WHERE CLI_CPF = '123.456.789-00'; 



-- Tabela FORNECEDORES

DELETE FROM FORNECEDORES WHERE FORN_CNPJ = '45.678.901/0001-33'; 



-- Tabela PRODUTOS

DELETE FROM PRODUTOS WHERE PROD_ID = 1;  



-- Tabela PRODUTOS_FORNECEDORES

DELETE FROM PRODUTOS_FORNECEDORES WHERE PROD_ID = 2 AND FORN_CNPJ = '12.345.678/0001-00'; 



-- Tabela PAGAMENTOS

DELETE FROM PAGAMENTOS WHERE PAG_ID = 4;  



-- Tabela VENDAS

DELETE FROM VENDAS WHERE VENDA_ID = 3;



-- Tabela VENDAS_PRODUTOS

DELETE FROM VENDAS_PRODUTOS WHERE VENDA_ID = 1 AND PROD_ID = 1; 


