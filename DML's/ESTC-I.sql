CREATE SCHEMA ESTC_I;
USE ESTC_I;

-- --------------------TABELA DE FORNECEDORES--------------------

CREATE TABLE IF NOT EXISTS FORNECEDORES(
  FORNEC_COD INT PRIMARY KEY,
  FORNEC_NOME VARCHAR(45) NOT NULL,
  FORNEC_RUA VARCHAR(45) NOT NULL,
  FORNEC_NUMRUA INT NOT NULL,
  FORNEC_BAIRRO VARCHAR(45) NOT NULL,
  FORNEC_CIDADE VARCHAR(45) NOT NULL,
  FORNEC_ESTADO VARCHAR(45) NOT NULL,
  FORNEC_PAIS VARCHAR(30) NOT NULL,
  FORNEC_CODPOSTAL VARCHAR(10) NOT NULL,
  FORNEC_TELEFONE VARCHAR(15) NOT NULL,
  FORNEC_CONTATO TEXT NOT NULL
);

-- --------------------TABELA DE FILIAIS--------------------

CREATE TABLE IF NOT EXISTS FILIAIS(
  FILIAL_COD INT PRIMARY KEY,
  FILIAL_NOME VARCHAR(45) NOT NULL,
  FILIAL_RUA VARCHAR(100) NOT NULL,
  FILIAL_NUMRUA INT NOT NULL,
  FILIAL_BAIRRO VARCHAR(50) NOT NULL,
  FILIAL_CIDADE VARCHAR(50) NOT NULL,
  FILIAL_ESTADO VARCHAR(50) NOT NULL,
  FILIAL_PAIS VARCHAR(50) NOT NULL,
  FILIAL_CODPOSTAL VARCHAR(10) NOT NULL,
  FILIAL_CAPACIDADE TEXT NOT NULL
);

-- --------------------TABELA DE PRODUTOS--------------------

CREATE TABLE IF NOT EXISTS PRODUTOS(
PROD_COD INT PRIMARY KEY,
PROD_NOME VARCHAR(50) NOT NULL,
PROD_DESCRICAO TEXT NOT NULL,
PROD_ESPECTEC TEXT NOT NULL,
PROD_QUANT DECIMAL(10,3) NOT NULL,
PROD_PRECOUNIT DECIMAL(10,2) NOT NULL,
PROD_UNIDMEDIDA VARCHAR(10) NOT NULL,
PROD_ESTOQ_MIN DECIMAL(10,3) NOT NULL
);

-- --------------------TABELA DE PEDIDOS--------------------

CREATE TABLE IF NOT EXISTS PEDIDOS(
PED_CODIGO INT PRIMARY KEY,
PED_DATA DATE NOT NULL,
PED_HORA TIME NOT NULL,
PED_PREVISAO DATE NOT NULL,
PED_STATUS ENUM('PENDENTE','CONCLUÍDO','EM ESPERA'),
PED_FORNECEDOR INT NOT NULL, #NOSSA CHAVE ESTRANGEIRA DE FORNECEDOR
#CRIANDO A REFERENCIA PARA A CHAVE ESTRANGEIRA
#RESTRIÇÃO APELIDO CH.ESTRANGEIRA(CAMPO CRIADO) REFERENCIA TABELA(CH.PRIMÁRIA)
CONSTRAINT FK_FORNECEDOR FOREIGN KEY (PED_FORNECEDOR) #DAR NOME A RESTRIÇÃO(CONSTRAINT) É UMA BOA PRÁTICA
REFERENCES FORNECEDORES(FORNEC_COD) #REFERENCIA A CHAVE PRIMÁRIA DE FORNECEDORES
);

-- --------------------TABELA DE RECEBIMENTOS--------------------

CREATE TABLE IF NOT EXISTS RECEBIMENTOS(
  PED_COD INT PRIMARY KEY,
  RECEB_DATA DATE NOT NULL,
  RECEB_HORA TIME NOT NULL,
  RECEB_QUANT_PROD DECIMAL(10,3),
  RECEB_CONDICAO TEXT NOT NULL,
  RECEB_PEDIDOS INT PRIMARY KEY,
  CONSTRAINT FK_PEDIDOS FOREIGN KEY(RECEB_PEDIDOS) REFERENCES PEDIDOS(PED_CODIGO));

-- --------------------ASSOCIATIVA ENTRE PEDIDOS E PRODUTOS--------------------

CREATE TABLE IF NOT EXISTS PEDIDOS_PRODUTOS(
  PDPR_PEDIDOS INT,
  PDPR_PRODUTOS INT,
  PRIMARY KEY(PDPR_PEDIDOS, PDPR_PRODUTOS),
  PDPR_QUANT DECIMAL(10,3) NOT NULL,
  CONSTRAINT PDPR_FK_PEDIDOS FOREIGN KEY(PDPR_PEDIDOS) REFERENCES PEDIDOS(PED_CODIGO),
  CONSTRAINT PDPR_FK_PRODUTOS FOREIGN KEY(PDPR_PRODUTOS) REFERENCES PRODUTOS(PROD_COD)
);

-- --------------------ASSOCIATIVA ENTRE FILIAIS E PRODUTOS--------------------

CREATE TABLE IF NOT EXISTS FILIAIS_PRODUTOS(
  FLPR_FILIAL INT,
  FLPR_PRODUTOS INT,
  PRIMARY KEY(FLPR_FILIAL,FLPR_PRODUTOS),
  FLPR_QUANT DECIMAL(10,3) NOT NULL,
  CONSTRAINT FLPR_FK_FILIAIS FOREIGN KEY(FLPR_FILIAL) REFERENCES FILIAIS(FILIAL_COD),
  CONSTRAINT FLPR_FK_PRODUTOS FOREIGN KEY(FLPR_PRODUTOS) REFERENCES PRODUTOS(PROD_COD)
);
-- --------------------ASSOCIATIVA ENTRE FORNECEDORES E PRODUTOS--------------------

CREATE TABLE IF NOT EXISTS FORNECEDORES_PRODUTOS(
  FRPR_FORNECEDOR INT,
  FRPR_PRODUTOS INT,
  PRIMARY KEY(FRPR_FORNECEDOR,FRPR_PRODUTOS),
  CONSTRAINT FRPR_FK_FORNECEDORES FOREIGN KEY(FRPR_FORNECEDOR) REFERENCES FORNECEDORES(FORNEC_COD),
  CONSTRAINT FRPR_FK_PRODUTOS FOREIGN KEY(FRPR_PRODUTOS) REFERENCES PRODUTOS(PROD_COD)
);

-- =====================> INSERTS <=====================

-- INSERTS para a Tabela FORNECEDORES

INSERT INTO FORNECEDORES (FORNEC_COD, FORNEC_NOME, FORNEC_RUA, FORNEC_NUMRUA, FORNEC_BAIRRO, FORNEC_CIDADE, FORNEC_ESTADO, FORNEC_PAIS, FORNEC_CODPOSTAL, FORNEC_TELEFONE, FORNEC_CONTATO)
VALUES (1, 'República Galáctica', 'Coruscant Central', 123, 'Senado Galáctico', 'Coruscant', 'Coruscant System', 'Galáxia', '01010-000', '(11) 1234-5678', 'Contato: Palpatine');

INSERT INTO FORNECEDORES (FORNEC_COD, FORNEC_NOME, FORNEC_RUA, FORNEC_NUMRUA, FORNEC_BAIRRO, FORNEC_CIDADE, FORNEC_ESTADO, FORNEC_PAIS, FORNEC_CODPOSTAL, FORNEC_TELEFONE, FORNEC_CONTATO)
VALUES (2, 'Império Galáctico', 'Imperial Palace', 200, 'Coruscant', 'Coruscant', 'Galactic Core', 'Galáxia', '01310-000', '(11) 8765-4321', 'Contato: Darth Vader');

INSERT INTO FORNECEDORES (FORNEC_COD, FORNEC_NOME, FORNEC_RUA, FORNEC_NUMRUA, FORNEC_BAIRRO, FORNEC_CIDADE, FORNEC_ESTADO, FORNEC_PAIS, FORNEC_CODPOSTAL, FORNEC_TELEFONE, FORNEC_CONTATO)
VALUES (3, 'Aliança Rebelde', 'Echo Base', 75, 'Hoth', 'Hoth', 'Outer Rim', 'Galáxia', '22030-000', '(21) 3333-9999', 'Contato: Leia Organa');

INSERT INTO FORNECEDORES (FORNEC_COD, FORNEC_NOME, FORNEC_RUA, FORNEC_NUMRUA, FORNEC_BAIRRO, FORNEC_CIDADE, FORNEC_ESTADO, FORNEC_PAIS, FORNEC_CODPOSTAL, FORNEC_TELEFONE, FORNEC_CONTATO)
VALUES (4, 'Hutt Cartel', 'Palácio de Jabba', 500, 'Tatooine', 'Tatooine', 'Outer Rim', 'Galáxia', '30130-000', '(31) 4444-5555', 'Contato: Jabba the Hutt');

INSERT INTO FORNECEDORES (FORNEC_COD, FORNEC_NOME, FORNEC_RUA, FORNEC_NUMRUA, FORNEC_BAIRRO, FORNEC_CIDADE, FORNEC_ESTADO, FORNEC_PAIS, FORNEC_CODPOSTAL, FORNEC_TELEFONE, FORNEC_CONTATO)
VALUES (5, 'Separatistas', 'Geonosis Prime', 900, 'Geonosis', 'Geonosis', 'Outer Rim', 'Galáxia', '90000-000', '(51) 5555-6666', 'Contato: Count Dooku');



-- INSERTS para a Tabela FILIAIS

INSERT INTO FILIAIS (FILIAL_COD, FILIAL_NOME, FILIAL_RUA, FILIAL_NUMRUA, FILIAL_BAIRRO, FILIAL_CIDADE, FILIAL_ESTADO, FILIAL_PAIS, FILIAL_CODPOSTAL, FILIAL_CAPACIDADE)
VALUES (1, 'Base Rebelde em Yavin', 'Templo Massassi', 1500, 'Yavin IV', 'Yavin', 'Yavin System', 'Galáxia', '05426-100', 'Capacidade: 200 membros');

INSERT INTO FILIAIS (FILIAL_COD, FILIAL_NOME, FILIAL_RUA, FILIAL_NUMRUA, FILIAL_BAIRRO, FILIAL_CIDADE, FILIAL_ESTADO, FILIAL_PAIS, FILIAL_CODPOSTAL, FILIAL_CAPACIDADE)
VALUES (2, 'Base Imperial em Coruscant', 'Imperial Palace', 123, 'Coruscant', 'Coruscant', 'Coruscant System', 'Galáxia', '01310-000', 'Capacidade: 500 stormtroopers');

INSERT INTO FILIAIS (FILIAL_COD, FILIAL_NOME, FILIAL_RUA, FILIAL_NUMRUA, FILIAL_BAIRRO, FILIAL_CIDADE, FILIAL_ESTADO, FILIAL_PAIS, FILIAL_CODPOSTAL, FILIAL_CAPACIDADE)
VALUES (3, 'Base Rebelde em Hoth', 'Echo Base', 600, 'Hoth', 'Hoth', 'Hoth System', 'Galáxia', '22030-000', 'Capacidade: 100 soldados');

INSERT INTO FILIAIS (FILIAL_COD, FILIAL_NOME, FILIAL_RUA, FILIAL_NUMRUA, FILIAL_BAIRRO, FILIAL_CIDADE, FILIAL_ESTADO, FILIAL_PAIS, FILIAL_CODPOSTAL, FILIAL_CAPACIDADE)
VALUES (4, 'Base de Jabba', 'Palácio de Jabba', 500, 'Tatooine', 'Tatooine', 'Tatooine System', 'Galáxia', '30130-000', 'Capacidade: 50 membros');

INSERT INTO FILIAIS (FILIAL_COD, FILIAL_NOME, FILIAL_RUA, FILIAL_NUMRUA, FILIAL_BAIRRO, FILIAL_CIDADE, FILIAL_ESTADO, FILIAL_PAIS, FILIAL_CODPOSTAL, FILIAL_CAPACIDADE)
VALUES (5, 'Base Separatista', 'Geonosis Prime', 900, 'Geonosis', 'Geonosis', 'Geonosis System', 'Galáxia', '90010-000', 'Capacidade: 250 droides de batalha');




-- INSERTS para a Tabela PRODUTOS

INSERT INTO PRODUTOS (PROD_COD, PROD_NOME, PROD_DESCRICAO, PROD_ESPECTEC, PROD_QUANT, PROD_PRECOUNIT, PROD_UNIDMEDIDA, PROD_ESTOQ_MIN)
VALUES (1, 'Lightsaber', 'Sabre de luz Jedi, utilizado pelos Cavaleiros Jedi', 'Habilidade: Corte, Bloqueio', 500.000, 1000.00, 'Unidade', 50.000);

INSERT INTO PRODUTOS (PROD_COD, PROD_NOME, PROD_DESCRICAO, PROD_ESPECTEC, PROD_QUANT, PROD_PRECOUNIT, PROD_UNIDMEDIDA, PROD_ESTOQ_MIN)
VALUES (2, 'TIE Fighter', 'Caça TIE de combate utilizado pelo Império Galáctico', 'Velocidade: Alta, Arma: Laser', 300.000, 50000.00, 'Unidade', 30.000);

INSERT INTO PRODUTOS (PROD_COD, PROD_NOME, PROD_DESCRICAO, PROD_ESPECTEC, PROD_QUANT, PROD_PRECOUNIT, PROD_UNIDMEDIDA, PROD_ESTOQ_MIN)
VALUES (3, 'X-Wing Fighter', 'Caça X-Wing usado pela Aliança Rebelde', 'Velocidade: Alta, Arma: Canhão laser', 1500.000, 20000.00, 'Unidade', 100.000);

INSERT INTO PRODUTOS (PROD_COD, PROD_NOME, PROD_DESCRICAO, PROD_ESPECTEC, PROD_QUANT, PROD_PRECOUNIT, PROD_UNIDMEDIDA, PROD_ESTOQ_MIN)
VALUES (4, 'Death Star', 'Estrela da Morte, arma planetária do Império', 'Destruição de planetas', 1000.000, 1000000.00, 'Unidade', 200.000);

INSERT INTO PRODUTOS (PROD_COD, PROD_NOME, PROD_DESCRICAO, PROD_ESPECTEC, PROD_QUANT, PROD_PRECOUNIT, PROD_UNIDMEDIDA, PROD_ESTOQ_MIN)
VALUES (5, 'Droid R2-D2', 'Droid astromech da Aliança Rebelde', 'Função: Assistência, Reparo', 2000.000, 500.00, 'Unidade', 500.000);



-- INSERTS para a Tabela PEDIDOS

INSERT INTO PEDIDOS (PED_CODIGO, PED_DATA, PED_HORA, PED_PREVISAO, PED_STATUS, PED_FORNECEDOR)
VALUES (1, '2024-11-01', '10:30:00', '2024-11-05', 'Pendente', 1);

INSERT INTO PEDIDOS (PED_CODIGO, PED_DATA, PED_HORA, PED_PREVISAO, PED_STATUS, PED_FORNECEDOR)
VALUES (2, '2024-11-02', '14:00:00', '2024-11-06', 'Enviado', 2);

INSERT INTO PEDIDOS (PED_CODIGO, PED_DATA, PED_HORA, PED_PREVISAO, PED_STATUS, PED_FORNECEDOR)
VALUES (3, '2024-11-03', '12:00:00', '2024-11-07', 'Finalizado', 3);

INSERT INTO PEDIDOS (PED_CODIGO, PED_DATA, PED_HORA, PED_PREVISAO, PED_STATUS, PED_FORNECEDOR)
VALUES (4, '2024-11-04', '16:00:00', '2024-11-08', 'Cancelado', 4);

INSERT INTO PEDIDOS (PED_CODIGO, PED_DATA, PED_HORA, PED_PREVISAO, PED_STATUS, PED_FORNECEDOR)
VALUES (5, '2024-11-05', '11:30:00', '2024-11-09', 'Pendente', 5);




-- INSERTS para a Tabela RECEBIMENTOS

INSERT INTO RECEBIMENTOS (REC_CODIGO, REC_DATA, REC_HORA, REC_QUANTIDADE, REC_VALOR, REC_PEDIDO, REC_FORNECEDOR)
VALUES (1, '2024-11-06', '09:00:00', 50, 50000.00, 1, 1);

INSERT INTO RECEBIMENTOS (REC_CODIGO, REC_DATA, REC_HORA, REC_QUANTIDADE, REC_VALOR, REC_PEDIDO, REC_FORNECEDOR)
VALUES (2, '2024-11-07', '11:30:00', 100, 200000.00, 2, 2);

INSERT INTO RECEBIMENTOS (REC_CODIGO, REC_DATA, REC_HORA, REC_QUANTIDADE, REC_VALOR, REC_PEDIDO, REC_FORNECEDOR)
VALUES (3, '2024-11-08', '14:45:00', 150, 300000.00, 3, 3);

INSERT INTO RECEBIMENTOS (REC_CODIGO, REC_DATA, REC_HORA, REC_QUANTIDADE, REC_VALOR, REC_PEDIDO, REC_FORNECEDOR)
VALUES (4, '2024-11-09', '13:15:00', 20, 200000.00, 4, 4);

INSERT INTO RECEBIMENTOS (REC_CODIGO, REC_DATA, REC_HORA, REC_QUANTIDADE, REC_VALOR, REC_PEDIDO, REC_FORNECEDOR)
VALUES (5, '2024-11-10', '16:00:00', 250, 125000.00, 5, 5);




-- INSERTS para a Tabela PEDIDOS_PRODUTOS

INSERT INTO PEDIDOS_PRODUTOS (PDPR_PEDIDOS, PDPR_PRODUTOS, PDPR_QUANT)
VALUES (1, 1, 100.000);

INSERT INTO PEDIDOS_PRODUTOS (PDPR_PEDIDOS, PDPR_PRODUTOS, PDPR_QUANT)
VALUES (2, 2, 150.000);

INSERT INTO PEDIDOS_PRODUTOS (PDPR_PEDIDOS, PDPR_PRODUTOS, PDPR_QUANT)
VALUES (3, 3, 200.000);

INSERT INTO PEDIDOS_PRODUTOS (PDPR_PEDIDOS, PDPR_PRODUTOS, PDPR_QUANT)
VALUES (4, 4, 250.000);

INSERT INTO PEDIDOS_PRODUTOS (PDPR_PEDIDOS, PDPR_PRODUTOS, PDPR_QUANT)
VALUES (5, 5, 300.000);



-- INSERÇÃO para a Tabela FILIAIS_PRODUTOS

INSERT INTO FILIAIS_PRODUTOS (FLPR_FILIAL, FLPR_PRODUTOS, FLPR_QUANT)
VALUES (1, 1, 100.000);

INSERT INTO FILIAIS_PRODUTOS (FLPR_FILIAL, FLPR_PRODUTOS, FLPR_QUANT)
VALUES (2, 2, 150.000);

INSERT INTO FILIAIS_PRODUTOS (FLPR_FILIAL, FLPR_PRODUTOS, FLPR_QUANT)
VALUES (3, 3, 200.000);

INSERT INTO FILIAIS_PRODUTOS (FLPR_FILIAL, FLPR_PRODUTOS, FLPR_QUANT)
VALUES (4, 4, 250.000);

INSERT INTO FILIAIS_PRODUTOS (FLPR_FILIAL, FLPR_PRODUTOS, FLPR_QUANT)
VALUES (5, 5, 300.000);




-- INSERÇÃO para a Tabela FORNECEDORES_PRODUTOS

INSERT INTO FORNECEDORES_PRODUTOS (FRPR_FORNECEDOR, FRPR_PRODUTOS)
VALUES (1, 1);

INSERT INTO FORNECEDORES_PRODUTOS (FRPR_FORNECEDOR, FRPR_PRODUTOS)
VALUES (2, 2);

INSERT INTO FORNECEDORES_PRODUTOS (FRPR_FORNECEDOR, FRPR_PRODUTOS)
VALUES (3, 3);

INSERT INTO FORNECEDORES_PRODUTOS (FRPR_FORNECEDOR, FRPR_PRODUTOS)
VALUES (4, 4);

INSERT INTO FORNECEDORES_PRODUTOS (FRPR_FORNECEDOR, FRPR_PRODUTOS)
VALUES (5, 5);





-- =====================> UPDATES <=====================

-- Atualizando FORNECEDORES

UPDATE FORNECEDORES SET FORNEC_NOME = 'Han Solo' WHERE FORNEC_COD = 1;
UPDATE FORNECEDORES SET FORNEC_TELEFONE = '(11) 9876-5432' WHERE FORNEC_COD = 2;



-- Atualizando FILIAIS

UPDATE FILIAIS SET FILIAL_CAPACIDADE = 'Capacidade: 250 stormtroppers' WHERE FILIAL_COD = 3;
UPDATE FILIAIS SET FILIAL_RUA = 'Rua uma Nova Esperença', FILIAL_NUMRUA = 100, FILIAL_BAIRRO = 'Yoda' WHERE FILIAL_COD = 4;



-- Atualizando PRODUTOS

UPDATE PRODUTOS SET PROD_QUANT = 350.000, PROD_PRECOUNIT = 60.00 WHERE PROD_COD = 2;
UPDATE PRODUTOS SET PROD_NOME = 'Phaser A-53', PROD_DESCRICAO = 'Produto para fins de aniquilação de raças' WHERE PROD_COD = 3;



-- Atualizando PEDIDOS

UPDATE PEDIDOS SET PED_PREVISAO = '2024-11-10', PED_STATUS = 'CONCLUÍDO' WHERE PED_CODIGO = 1;
UPDATE PEDIDOS SET PED_STATUS = 'Em uma galáxia bem distante', PED_FORNECEDOR = 3 WHERE PED_CODIGO = 4;



-- Atualizando RECEBIMENTOS

UPDATE RECEBIMENTOS SET RECEB_QUANT_PROD = 120.000, RECEB_CONDICAO = 'Recebido em perfeitas condições' WHERE RECEB_PEDIDOS = 2;
UPDATE RECEBIMENTOS SET RECEB_QUANT_PROD = 350.000, RECEB_CONDICAO = 'Recebido com pequeno atraso' WHERE RECEB_PEDIDOS = 5;



-- Atualizando PEDIDOS_PRODUTOS

UPDATE PEDIDOS_PRODUTOS SET PDPR_QUANT = 120.000 WHERE PDPR_PEDIDOS = 1 AND PDPR_PRODUTOS = 1;
UPDATE PEDIDOS_PRODUTOS SET PDPR_QUANT = 180.000 WHERE PDPR_PEDIDOS = 3 AND PDPR_PRODUTOS = 2;



-- Atualizando FILIAIS

UPDATE FILIAIS_PRODUTOS SET FLPR_QUANT = 180.000 WHERE FLPR_FILIAL = 2 AND FLPR_PRODUTOS = 2;
UPDATE FILIAIS_PRODUTOS SET FLPR_QUANT = 230.000 WHERE FLPR_FILIAL = 4 AND FLPR_PRODUTOS = 4;



-- Atualizando FORNECEDORES_PRODUTOS

UPDATE FORNECEDORES_PRODUTOS SET FRPR_FORNECEDOR = 2 WHERE FRPR_PRODUTOS = 1;
UPDATE FORNECEDORES_PRODUTOS SET FRPR_FORNECEDOR = 3 WHERE FRPR_PRODUTOS = 4;



-- =====================> DELETE <=====================

-- Deletando dados da tabela FORNECEDORES

DELETE FROM FORNECEDORES WHERE FORNEC_COD = 1;



-- Deletando dados da tabela FILIAIS

DELETE FROM FILIAIS WHERE FILIAL_COD = 1;  



-- Deletando dados da tabela PRODUTOS

DELETE FROM PRODUTOS WHERE PROD_COD = 1;



-- Deletando dados da tabela PEDIDOS

DELETE FROM PEDIDOS WHERE PED_CODIGO = 1; 



-- Deletando daods da tabela RECEBIMENTOS

DELETE FROM RECEBIMENTOS WHERE RECEB_PEDIDOS = 1;



-- Deletando dados da tabela PEDIDSO_PRODUTOS

DELETE FROM PEDIDOS_PRODUTOS WHERE PDPR_PEDIDOS = 1;



-- Deletando dados da tabela FILIAIS_PRODUTOS

DELETE FROM FILIAIS_PRODUTOS WHERE FLPR_FILIAL = 1;



-- Deletando dados da tabela FORNECEDORES_PRODUTOS

DELETE FROM FORNECEDORES_PRODUTOS WHERE FRPR_FORNECEDOR = 1;


